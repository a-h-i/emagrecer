language: 'typescript'
type: application

fileGroups:
  configs:
    - 'package.json'
    - 'tsconfig.json'
    - 'eslint.config.mjs'
  sources:
    - 'src/**/*'

tasks:
  build:
    script: pnpm run build
    inputs:
      - '@files(configs)'
      - '@files(sources)'
    outputs:
      - 'dist'
    deps:
      - 'storage:build'
  migrate:
    script: pnpm run migrate
    deps:
      - 'build'
  lint:
    inputs:
      - '@files(configs)'
      - '@files(sources)'
    script: pnpm run lint
    deps:
      - 'build'
  format:
    inputs:
      - '@files(configs)'
      - '@files(sources)'
    options:
      runInCI: false
    script: pnpm run format
    deps:
      - 'build'
  checkFormat:
    command: pnpm run format:check
    inputs:
      - '@files(configs)'
      - '@files(sources)'
